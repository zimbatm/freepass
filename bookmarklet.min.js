(function(p){var D=p.document,f="${homeUrl}",j="${homeDomain}",z="${version}",a="freepass",q="#ddffdd",r=[],n=false,B,l,A,u,h,g,x;if(D.getElementById(a)){return}if(D.activeElement.type&&D.activeElement.type.toLowerCase()=="password"){B=D.activeElement}u=D.createElement("div");u.id=a;i(u.style,{padding:0,margin:0,border:"1px solid #aaaaaa",font:"normal 12px",fontFamily:"Trebuchet MS, Helvetica, Arial, sans-serif",textAlign:"right",position:"fixed",top:"10px",left:"10px",color:"#333333",background:"#99aabb",zIndex:"1000000"});u.addEventListener("mousedown",d,false);h=D.createElement("span");i(h.style,{marginLeft:"2em",marginRight:"2em"});h.innerHTML="FreePass";g=D.createElement("input");i(g.style,{margin:0,padding:0,border:0,color:"inherit",background:"inherit",font:"inherit",borderRight:"1px solid #aaaaaa"});g.type="button";g.value="x";g.addEventListener("click",s,false);u.appendChild(g);u.appendChild(h);D.body.appendChild(u);p.addEventListener("message",v,false);C();function C(){if(A&&(!l||!l.closed)){return}b("Waiting for handshake");A=null;l=p.open(f)}function b(E){if(typeof p.console!=="undefined"){p.console.log(E)}h.innerHTML=E}function i(E,F){for(k in F){if(F.hasOwnProperty(k)){E[k]=F[k]}}}function c(E){E.stopPropagation();E.preventDefault()}function m(H,G,F){function E(){F.apply(this,arguments);H.removeEventListener(G,E,false)}H.addEventListener(G,E,false)}function d(H){var G=H.clientX-u.offsetLeft,F=H.clientY-u.offsetTop;c(H);if(!l){C();return}function E(I){c(I);u.style.left=I.clientX-G+"px";u.style.top=I.clientY-F+"px"}m(D,"mouseup",function(I){E(I);D.removeEventListener("mousemove",E,false)});D.addEventListener("mousemove",E,false)}function s(E){c(E);p.removeEventListener("message",v,false);if(n){D.removeEventListener("dblclick",e,true);y()}if(l){l.close()}D.body.removeChild(u)}function e(E){o(E.target)}function o(F){var E;if(F.nodeName.toLowerCase()==="input"&&F.type==="password"){if(!w(t)){E=F.style.cssText;i(F.style,{backgroundColor:q});F.value=x;r.push({elem:F,prevCss:E})}}}function w(F){for(var E=0;E<r.length;E++){if(r[E].elem===F){return true}}return false}function y(){var E;while((E=r.pop())){E.elem.style.cssText=E.prevCss}}function v(E){if(E.origin===j){if(E.data==="hello"){E.source.postMessage('{"version":'+version+"}",E.origin);A=E.source;b("Waiting for password");return}var F=JSON.parse(E.data);if(F.hasOwnProperty("password")){x=F.password;u.style.backgroundColor=q;if(!n){D.addEventListener("dblclick",e,true);n=true}else{y()}if(B){o(B)}b("Got password, double-click on field to insert")}else{throw new Error("why ??? (bug)",F)}}else{b(E.origin+"!=="+j)}}})(this);