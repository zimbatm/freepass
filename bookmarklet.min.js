(function(e){function w(){if(!(q&&(!f||!f.closed))){q=null;f=e.open(x,r)}}function j(){typeof e.console!=="undefined"&&console.log.apply(console.log,arguments)}function l(a,b){for(k in b)if(b.hasOwnProperty(k))a[k]=b[k]}function s(a){a.stopPropagation();a.preventDefault()}function D(a,b,t){function m(){t.apply(this,arguments);a[n](b,m,false)}a[g](b,m,false)}function E(a){function b(i){s(i);c.style.left=i.clientX-t+"px";c.style.top=i.clientY-m+"px"}var t=a.clientX-c.offsetLeft,m=a.clientY-c.offsetTop;
s(a);if(f){D(d,"mouseup",function(i){b(i);d[n]("mousemove",b,false)});d[g]("mousemove",b,false)}else w()}function F(a){s(a);e[n]("message",y,false);if(u){d[n]("dblclick",z,true);A()}f&&f.close();d.body.removeChild(c)}function z(a){a=a.target;var b;if(a.nodeName.toLowerCase()==="input"&&a.type==="password"){a:{for(b=0;b<o.length;b++)if(o[b].a===a){b=true;break a}b=false}if(!b){b=a.style.cssText;l(a.style,{backgroundColor:B});a.value=v;o.push({a:a,b:b})}}}function A(){for(var a;a=o.pop();)a.a.style.cssText=
a.b}function y(a){j("gotev",a,C);if(a.origin===C)if(a.data==="hello"){a.source.postMessage("world",a.origin);j("Handshake done, waiting for password");q=a.source}else{a=JSON.parse(a.data);if(a.hasOwnProperty("password")){v=a.password;j("Got password",v);c.style.backgroundColor=B;if(u)A();else{d[g]("dblclick",z,true);u=true}}else j("why ??? (bug)",a)}}var d=e.document,x="<?php echo $base_url; ?>",C="<?php echo $base_domain; ?>",r="fp<?php echo sha1(time()); ?>",B="#ddffdd",g="addEventListener",n="removeEventListener",
o=[],u=false,f,q,c,p,h,v;if(!e||!e.document)e.location=x;else if(!document.getElementById(r)){c=d.createElement("div");c.id=r;l(c.style,{padding:0,margin:0,border:"1px solid #aaaaaa",font:"normal 12px",fontFamily:"Trebuchet MS, Helvetica, Arial, sans-serif",textAlign:"right",position:"fixed",top:"10px",color:"#333333",background:"#99aabb",zIndex:"1000000"});c[g]("mousedown",E,false);p=d.createElement("span");l(p.style,{marginLeft:"2em",marginRight:"2em"});p.innerHTML="FreePass";h=d.createElement("input");
l(h.style,{margin:0,padding:0,border:0,color:"inherit",background:"inherit",font:"inherit",borderRight:"1px solid #aaaaaa"});h.type="button";h.value="x";h[g]("click",F,false);c.appendChild(h);c.appendChild(p);d.body.appendChild(c);e[g]("message",y,false);w()}})(this);
