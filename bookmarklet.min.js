(function(e){function t(){if(!(p&&(!f||!f.closed))){p=null;f=e.open(u,A)}}function j(a,b,h){typeof e.console!=="undefined"&&console.log(a,b,h)}function l(a,b){for(k in b)if(b.hasOwnProperty(k))a[k]=b[k]}function q(a){a.stopPropagation();a.preventDefault()}function B(a,b,h){function m(){h.apply(this,arguments);a.removeEventListener(b,m,false)}a.addEventListener(b,m,false)}function C(a){function b(i){q(i);c.style.left=i.clientX-h+"px";c.style.top=i.clientY-m+"px"}var h=a.clientX-c.offsetLeft,m=a.clientY-
c.offsetTop;q(a);if(f){B(d,"mouseup",function(i){b(i);d.removeEventListener("mousemove",b,false)});d.addEventListener("mousemove",b,false)}else t()}function D(a){q(a);e.removeEventListener("message",v,false);if(r){d.removeEventListener("dblclick",w,true);x()}f&&f.close();d.body.removeChild(c)}function w(a){a=a.target;var b;if(a.nodeName.toLowerCase()==="input"&&a.type==="password"){a:{for(b=0;b<n.length;b++)if(n[b].a===a){b=true;break a}b=false}if(!b){b=a.style.cssText;l(a.style,{backgroundColor:y});
a.value=s;n.push({a:a,b:b})}}}function x(){for(var a;a=n.pop();)a.a.style.cssText=a.b}function v(a){j("gotev",a,z);if(a.origin===z)if(a.data==="hello"){a.source.postMessage("world",a.origin);j("Handshake done, waiting for password");p=a.source}else{a=JSON.parse(a.data);if(a.hasOwnProperty("password")){s=a.password;j("Got password",s);c.style.backgroundColor=y;if(r)x();else{d.addEventListener("dblclick",w,true);r=true}}else j("why ??? (bug)",a)}}var d=e.document,u="${homeUrl}",z="${homeDomain}",A=
"${fwid}",y="#ddffdd",n=[],r=false,f,p,c,o,g,s;if(!e||!e.document)e.location=u;else if(!document.getElementById("${fid}")){c=d.createElement("div");c.id="${fid}";l(c.style,{padding:0,margin:0,border:"1px solid #aaaaaa",font:"normal 12px",fontFamily:"Trebuchet MS, Helvetica, Arial, sans-serif",textAlign:"right",position:"fixed",top:"10px",left:"10px",color:"#333333",background:"#99aabb",zIndex:"1000000"});c.addEventListener("mousedown",C,false);o=d.createElement("span");l(o.style,{marginLeft:"2em",
marginRight:"2em"});o.innerHTML="FreePass";g=d.createElement("input");l(g.style,{margin:0,padding:0,border:0,color:"inherit",background:"inherit",font:"inherit",borderRight:"1px solid #aaaaaa"});g.type="button";g.value="x";g.addEventListener("click",D,false);c.appendChild(g);c.appendChild(o);d.body.appendChild(c);e.addEventListener("message",v,false);t()}})(this);
